(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[448],{1861:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/_register",function(){return s(4609)}])},3646:e=>{e.exports={container:"Page_container__4TqKj",main:"Page_main__MOW5Q",bold:"Page_bold__FOjUO",code:"Page_code__gdauj",grid:"Page_grid__YvlVv",card:"Page_card__qrbpT",description:"Page_description__F5wod",title:"Page_title__XbhM_"}},4609:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>o});var t=s(7876),r=s(3646),n=s.n(r),i=s(4232);let o=()=>{let[e,a]=(0,i.useState)(null);return(0,i.useEffect)(()=>{a(localStorage),localStorage.getItem("idToken")&&(alert("すでにログインしているため、ポータルページに移動します。"),window.location.href="/portal");let e=new URLSearchParams(window.location.search).get("code");if(e){fetch("https://api.osudenken4dev.workers.dev/invite/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})}).then(e=>e.json()).then(e=>{e.valid||(alert("この招待コードは無効か期限切れです。"),window.location.href="/_register/")});let a=document.querySelector('input[name="passphrase"]');if(a){a.value=e,a.style.display="none";let s=document.getElementById("passphrase-label");s&&(s.style.display="none")}}},[]),(0,t.jsx)("div",{className:n().container,children:(0,t.jsxs)("main",{className:n().main,children:[(0,t.jsx)("h1",{children:"新規ユーザー登録"}),(0,t.jsxs)("p",{className:n().description,children:["大産大 電研部員のみが利用できるユーザーを作成します。",(0,t.jsx)("br",{}),"なお、部員ではない場合は却下されます。",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"学籍番号は先頭にsを付けてください。"]}),(0,t.jsxs)("form",{onSubmit:function(e){e.preventDefault();let a=new FormData(e.currentTarget),s=a.get("email");fetch("https://api.osudenken4dev.workers.dev/user/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:a.get("password"),passphrase:a.get("passphrase")})}).then(e=>e.json()).then(e=>e.error?"EMAIL_EXISTS"===e.error.message?void alert("そのメールアドレスは既に使われています。"):void console.error("Registration error:",e):e.body&&"Invalid passphrase"===e.body.error?void alert("合言葉が間違っています。"):void(e.success?(alert("ユーザー登録が完了しました。ログインページに移動します。"),window.location.href="/?i=portal/#login"):(console.error("Registration failed:",e),alert("ユーザー登録に失敗しました。"))))},children:[(0,t.jsxs)("label",{children:["学籍番号もしくはメールアドレス (osaka-sandai.ac.jpのみ)",(0,t.jsx)("input",{type:"text",name:"email"})]}),(0,t.jsxs)("label",{children:["パスワード",(0,t.jsx)("input",{type:"password",name:"password"})]}),(0,t.jsxs)("label",{id:"passphrase-label",children:["合言葉",(0,t.jsx)("input",{type:"text",name:"passphrase"})]}),(0,t.jsx)("br",{}),(0,t.jsx)("input",{type:"submit",value:"作成する"})]})]})})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=1861)),_N_E=e.O()}]);