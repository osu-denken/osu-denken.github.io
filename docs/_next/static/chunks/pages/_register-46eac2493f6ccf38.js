(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[448],{1861:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/_register",function(){return t(4609)}])},3646:e=>{e.exports={container:"Page_container__4TqKj",main:"Page_main__MOW5Q",bold:"Page_bold__FOjUO",code:"Page_code__gdauj",grid:"Page_grid__YvlVv",card:"Page_card__qrbpT",description:"Page_description__F5wod",title:"Page_title__XbhM_"}},4609:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>o});var r=t(7876),s=t(3646),n=t.n(s),i=t(4232);let o=()=>{let[e,a]=(0,i.useState)(null);return(0,i.useEffect)(()=>{a(localStorage),localStorage.getItem("idToken")&&(alert("すでにログインしているため、ポータルページに移動します。"),window.location.href="/portal");let e=new URLSearchParams(window.location.search).get("code");if(e){fetch("https://api.osudenken4dev.workers.dev/invite/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})}).then(e=>e.json()).then(e=>{if(!e.valid)return void alert("この招待コードは無効か期限切れです。")});let a=document.querySelector('input[name="passphrase"]');a&&(a.value=e,a.style.display="none")}},[]),(0,r.jsx)("div",{className:n().container,children:(0,r.jsxs)("main",{className:n().main,children:[(0,r.jsx)("h1",{children:"新規ユーザー登録"}),(0,r.jsxs)("p",{className:n().description,children:["大産大 電研部員のみが利用できるユーザーを作成します。",(0,r.jsx)("br",{}),"なお、部員ではない場合は却下されます。"]}),(0,r.jsxs)("form",{onSubmit:function(e){e.preventDefault();let a=new FormData(e.currentTarget),t=a.get("email");fetch("https://api.osudenken4dev.workers.dev/user/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:a.get("password"),passphrase:a.get("passphrase")})}).then(e=>e.json()).then(e=>e.error?"EMAIL_EXISTS"===e.error.message?void alert("そのメールアドレスは既に使われています。"):void console.error("Registration error:",e):e.body&&"Invalid passphrase"===e.body.error?void alert("合言葉が間違っています。"):void(e.success?(alert("ユーザー登録が完了しました。ログインページに移動します。"),window.location.href="/?i=portal/#login"):(console.error("Registration failed:",e),alert("ユーザー登録に失敗しました。"))))},children:[(0,r.jsxs)("label",{children:["学籍番号もしくはメールアドレス (osaka-sandai.ac.jpのみ)",(0,r.jsx)("input",{type:"text",name:"email"})]}),(0,r.jsxs)("label",{children:["パスワード",(0,r.jsx)("input",{type:"password",name:"password"})]}),(0,r.jsxs)("label",{children:["合言葉",(0,r.jsx)("input",{type:"text",name:"passphrase"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{type:"submit",value:"作成する"})]})]})})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=1861)),_N_E=e.O()}]);