(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{2577:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/portal/blog",function(){return n(4332)}])},3646:e=>{e.exports={container:"Page_container__4TqKj",main:"Page_main__MOW5Q",bold:"Page_bold__FOjUO",code:"Page_code__gdauj",grid:"Page_grid__YvlVv",card:"Page_card__qrbpT",description:"Page_description__F5wod",title:"Page_title__XbhM_"}},4332:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(7876),a=n(3646),l=n.n(a),r=n(9455),i=n.n(r),s=n(4232);let c=()=>{let e=new Date().toISOString().split("T")[0],[t,n]=(0,s.useState)("new"),[a,r]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[p,u]=(0,s.useState)(null),[_,h]=(0,s.useState)(null),[g,m]=(0,s.useState)(null);return(0,s.useEffect)(()=>{h(localStorage);let t=localStorage.getItem("idToken"),o=new URLSearchParams(window.location.search);if(!t){let e=encodeURIComponent("portal/blog/"+window.location.search);window.location.href="/?i="+e+"#login"}let a=o.get("msg");a&&r(a);let l=o.get("action");l&&n(l);let i=o.get("page");i&&d(i),"edit"===l&&fetch("https://api.osudenken4dev.workers.dev/v1/blog/get?page="+i,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{t.content?m(t):m({content:'---\ntitle: "今日の活動報告"\ndate: '+e+"\ncategories: []\ntags: [活動報告]\nlayout: default\n---\n\nここからMarkdown記法で本文を記述します。\n"})})},[]),(0,o.jsx)("div",{className:l().container,children:(0,o.jsxs)("main",{className:l().main,children:[a?(0,o.jsx)("div",{className:i().notice,children:a}):"","new"===t?(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{children:"新しく投稿"}),(0,o.jsx)("p",{children:"新しいブログ記事を作成します。"}),(0,o.jsx)("form",{children:(0,o.jsxs)("div",{className:i().inputGroup,children:[(0,o.jsx)("input",{type:"text",name:"page",placeholder:"ファイル名",className:i().portal,defaultValue:new Date().toISOString().split("T")[0]+"-"+(new Date().getHours()+new Date().getMinutes()+new Date().getSeconds()),required:!0}),(0,o.jsx)("button",{type:"button",className:i().portal,onClick:()=>{let e=document.querySelector('input[name="page"]').value.trim();if(!e)return void r("ファイル名を入力してください。");let t=encodeURIComponent(e);window.location.href="/portal/blog/?action=edit&page=".concat(t)},children:"編集"})]})})]}):(0,o.jsxs)("div",{children:[(0,o.jsxs)("h1",{children:[c," の編集"]}),(0,o.jsxs)("form",{children:[(0,o.jsx)("div",{className:i().inputGroup,children:(0,o.jsx)("textarea",{name:"content",style:{width:"100%",height:"50vh"},className:i().portal,defaultValue:g?g.content:""})}),(0,o.jsxs)("div",{className:i().inputGroup,children:[(0,o.jsx)("button",{type:"button",className:i().portal,onClick:()=>{let e=document.querySelector('textarea[name="content"]').value;fetch("https://api.osudenken4dev.workers.dev/v1/blog/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("idToken"),page:c},body:e}).then(e=>e.json()).then(e=>{e.success?r("保存しました。"):r("保存に失敗しました。")})},children:"保存"}),(0,o.jsx)("button",{type:"button",className:i().portal,style:{backgroundColor:"#a66666"},onClick:()=>{confirm("本当に削除しますか？この操作は取り消せません。")&&fetch("https://api.osudenken4dev.workers.dev/blog/delete",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("idToken"),page:c}}).then(e=>e.json()).then(e=>{if(e.success){let e=encodeURIComponent("portal/blog/");window.location.href="/?msg="+encodeURIComponent("削除しました。")+"&i="+e+"#portal/blog"}else r("削除に失敗しました。")})},children:"削除"}),(0,o.jsx)("button",{type:"button",className:i().portal,onClick:()=>{window.location.href="/portal/?tab=blog"},style:{marginLeft:"auto"},children:"キャンセル"})]})]})]})]})})}},9455:e=>{e.exports={tabContainer:"Portal_tabContainer__VrhzM",tabButton:"Portal_tabButton__GgWUH",active:"Portal_active__zVMzA",tabContent:"Portal_tabContent__j21tP",portal:"Portal_portal__UHmCy",inputGroup:"Portal_inputGroup__kOtrD",notice:"Portal_notice__fvfef",grid:"Portal_grid__MBxHh",card:"Portal_card__QB5cC"}}},e=>{e.O(0,[636,593,792],()=>e(e.s=2577)),_N_E=e.O()}]);