(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{2577:(e,t,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/portal/blog",function(){return o(4332)}])},3646:e=>{e.exports={container:"Page_container__4TqKj",main:"Page_main__MOW5Q",bold:"Page_bold__FOjUO",code:"Page_code__gdauj",grid:"Page_grid__YvlVv",card:"Page_card__qrbpT",description:"Page_description__F5wod",title:"Page_title__XbhM_"}},4332:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>c});var n=o(7876),a=o(3646),l=o.n(a),r=o(9455),i=o.n(r),s=o(4232);let c=()=>{let[e,t]=(0,s.useState)("new"),[o,a]=(0,s.useState)(""),[r,c]=(0,s.useState)(""),[d,p]=(0,s.useState)(null),[u,_]=(0,s.useState)(null),[h,g]=(0,s.useState)(null);return(0,s.useEffect)(()=>{_(localStorage);let e=localStorage.getItem("idToken"),o=new URLSearchParams(window.location.search);if(!e){let e=encodeURIComponent("portal/blog/"+window.location.search);window.location.href="/?i="+e+"#login"}let n=o.get("msg");n&&a(n);let l=o.get("action");l&&t(l);let r=o.get("page");r&&c(r),"edit"===l&&fetch("https://api.osudenken4dev.workers.dev/v1/blog/get?page="+r,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{g(e)})},[]),(0,n.jsx)("div",{className:l().container,children:(0,n.jsxs)("main",{className:l().main,children:[o?(0,n.jsx)("div",{className:i().notice,children:o}):"","new"===e?(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"新しく投稿"}),(0,n.jsx)("p",{children:"新しいブログ記事を作成します。"}),(0,n.jsx)("form",{children:(0,n.jsxs)("div",{className:i().inputGroup,children:[(0,n.jsx)("input",{type:"text",name:"page",placeholder:"ファイル名",className:i().portal,value:new Date().toISOString().split("T")[0]+"-"+(new Date().getHours()+new Date().getMinutes()+new Date().getSeconds()),required:!0}),(0,n.jsx)("button",{type:"button",className:i().portal,onClick:()=>{let e=document.querySelector('input[name="page"]').value.trim();if(!e)return void a("ファイル名を入力してください。");let t=encodeURIComponent(e);window.location.href="/portal/blog/?action=edit&page=".concat(t)},children:"編集"})]})})]}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{children:[r," の編集"]}),(0,n.jsxs)("form",{children:[(0,n.jsx)("div",{className:i().inputGroup,children:(0,n.jsx)("textarea",{name:"content",style:{width:"100%",height:"50vh"},className:i().portal,defaultValue:h?h.content:""})}),(0,n.jsxs)("div",{className:i().inputGroup,children:[(0,n.jsx)("button",{type:"button",className:i().portal,onClick:()=>{let e=document.querySelector('textarea[name="content"]').value;fetch("https://api.osudenken4dev.workers.dev/blog/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("idToken"),page:r},body:e}).then(e=>e.json()).then(e=>{e.success?a("保存しました。"):a("保存に失敗しました。")})},children:"保存"}),(0,n.jsx)("button",{type:"button",className:i().portal,style:{backgroundColor:"#a66666"},onClick:()=>{confirm("本当に削除しますか？この操作は取り消せません。")&&fetch("https://api.osudenken4dev.workers.dev/blog/delete",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("idToken"),page:r}}).then(e=>e.json()).then(e=>{if(e.success){let e=encodeURIComponent("portal/blog/");window.location.href="/?msg="+encodeURIComponent("削除しました。")+"&i="+e+"#portal/blog"}else a("削除に失敗しました。")})},children:"削除"}),(0,n.jsx)("button",{type:"button",className:i().portal,onClick:()=>{window.location.href="/portal/?tab=blog"},children:"キャンセル"})]})]})]})]})})}},9455:e=>{e.exports={tabContainer:"Portal_tabContainer__VrhzM",tabButton:"Portal_tabButton__GgWUH",active:"Portal_active__zVMzA",tabContent:"Portal_tabContent__j21tP",portal:"Portal_portal__UHmCy",inputGroup:"Portal_inputGroup__kOtrD",notice:"Portal_notice__fvfef",grid:"Portal_grid__MBxHh",card:"Portal_card__QB5cC"}}},e=>{e.O(0,[636,593,792],()=>e(e.s=2577)),_N_E=e.O()}]);