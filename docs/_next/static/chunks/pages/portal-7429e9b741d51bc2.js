(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{4357:e=>{e.exports={container:"Page_container__4TqKj",main:"Page_main__MOW5Q",bold:"Page_bold__FOjUO",code:"Page_code__gdauj",grid:"Page_grid__YvlVv",card:"Page_card__qrbpT",description:"Page_description__F5wod",title:"Page_title__XbhM_"}},5816:e=>{e.exports={tabContainer:"Portal_tabContainer__VrhzM",tabButton:"Portal_tabButton__GgWUH",active:"Portal_active__zVMzA",tabContent:"Portal_tabContent__j21tP",portal:"Portal_portal__UHmCy",inputGroup:"Portal_inputGroup__kOtrD",notice:"Portal_notice__fvfef",grid:"Portal_grid__MBxHh",card:"Portal_card__QB5cC"}},6299:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/portal",function(){return a(9076)}])},9076:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var n=a(7876),s=a(4357),o=a.n(s),r=a(5816),l=a.n(r),c=a(4232),i=a(8230),d=a.n(i);let h=()=>{let[e,t]=(0,c.useState)("main"),[a,s]=(0,c.useState)(""),[r,i]=(0,c.useState)("Unknown"),[h,u]=(0,c.useState)(""),[p,_]=(0,c.useState)([]),[m,j]=(0,c.useState)(!1),[g,x]=(0,c.useState)("");async function b(e,t){try{let a=await fetch("https://api.osudenken4dev.workers.dev/user/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("idToken"))},body:JSON.stringify({[e]:t})}),n=await a.json();if(n.success)return console.log("".concat(e," updated successfully.")),!0;return console.error("Failed to update ".concat(e,".")),console.log(n),!1}catch(e){return console.error("Error:",e),!1}}return(0,c.useEffect)(()=>{"blog"!==e||m||fetch("https://api.osudenken4dev.workers.dev/blog/list",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{_(null!=e?e:[]),j(!0)}).catch(e=>{console.error("Failed to load blog list:",e)})},[e]),(0,c.useEffect)(()=>{localStorage.getItem("idToken")||(window.location.href="/?i=portal/#login");let e=localStorage.getItem("displayName");e&&i(e);let a=new URLSearchParams(window.location.search),n=a.get("msg");n&&s(n);let o=a.get("tab");o&&t(o),fetch("https://api.osudenken4dev.workers.dev/discord/invite",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("idToken"))}}).then(e=>e.json()).then(e=>{e.success&&x(e.code)}).catch(e=>{console.error("Failed to discord invite url:",e)})},[]),(0,n.jsx)("div",{className:o().container,children:(0,n.jsxs)("main",{className:o().main,children:[a?(0,n.jsx)("div",{className:l().notice,children:a}):"",(0,n.jsxs)("div",{className:l().tabContainer,children:[(0,n.jsx)("button",{className:"".concat(l().tabButton," ").concat("main"===e?l().active:""),onClick:()=>t("main"),children:"ポータル"}),(0,n.jsx)("button",{className:"".concat(l().tabButton," ").concat("settings"===e?l().active:""),onClick:()=>t("settings"),children:"設定"}),(0,n.jsx)("button",{className:"".concat(l().tabButton," ").concat("blog"===e?l().active:""),onClick:()=>t("blog"),children:"ブログ"})]}),(0,n.jsxs)("div",{className:l().tabContent,children:["main"===e&&(0,n.jsxs)("div",{className:l().tabPane,children:[(0,n.jsxs)("h1",{id:"title",children:["ようこそ、",r," さん"]}),(0,n.jsx)("p",{className:o().description,children:(0,n.jsx)(d(),{href:g,children:"Discordへ参加する"})})]}),"settings"===e&&(0,n.jsxs)("div",{className:l().tabPane,children:[(0,n.jsx)("h1",{children:"ユーザー設定"}),(0,n.jsx)("h2",{children:"ユーザー名"}),(0,n.jsxs)("p",{className:o().description,children:["デフォルトでは学籍番号が設定されています。",(0,n.jsx)("br",{}),"変更する場合は以下の入力欄に新しいユーザー名を入力し、更新ボタンを押してください。"]}),(0,n.jsx)("form",{children:(0,n.jsxs)("div",{className:l().inputGroup,children:[(0,n.jsx)("input",{type:"text",id:"usernameInput",placeholder:"ユーザー名",value:r,onChange:e=>i(e.target.value),className:l().portal}),(0,n.jsx)("button",{onClick:e=>{e.preventDefault();let t=document.getElementById("usernameInput").value.trim();t?b("displayName",t).then(e=>{e?(s("ユーザー名を更新しました。"),localStorage.setItem("displayName",t)):(console.log(e),alert("ユーザー名の更新に失敗しました。"))}):alert("有効なユーザー名を入力してください。")},className:l().portal,children:"更新"})]})}),(0,n.jsx)("br",{}),(0,n.jsx)("h2",{children:"メールアドレス"}),(0,n.jsxs)("p",{className:o().description,children:["デフォルトでは大学から付与されたメールアドレスが設定されています。",(0,n.jsx)("br",{}),"変更する場合は以下の入力欄に新しいメールアドレスを入力し、更新ボタンを押してください。"]}),(0,n.jsx)("form",{children:(0,n.jsxs)("div",{className:l().inputGroup,children:[(0,n.jsx)("input",{type:"text",id:"emailInput",placeholder:"メールアドレス",value:h,onChange:e=>u(e.target.value),className:l().portal}),(0,n.jsx)("button",{onClick:e=>{e.preventDefault();let t=document.getElementById("emailInput").value.trim();t?b("email",t).then(e=>{e?s("メールアドレスを更新しました。"):alert("メールアドレスの更新に失敗しました。")}):alert("有効なメールアドレスを入力してください。")},className:l().portal,children:"更新"})]})}),(0,n.jsx)("br",{}),(0,n.jsx)("h2",{children:"パスワードの再設定"}),(0,n.jsxs)("p",{className:o().description,children:["パスワードを再設定するには",(0,n.jsx)(d(),{href:"/resetpass/",children:"こちら"}),"からメールアドレスを入力してください。"]})]}),"blog"===e&&(0,n.jsxs)("div",{className:l().tabPane,children:[(0,n.jsx)("h1",{children:"ブログ"}),(0,n.jsx)("p",{className:o().description}),(0,n.jsx)("div",{className:l().grid,children:p.map(e=>(0,n.jsx)(d(),{href:"/blog/editor/?page="+e.name,children:(0,n.jsxs)("div",{className:l().card,children:[(0,n.jsx)("h3",{children:e.name}),(0,n.jsx)("p",{})]})},e.sha))})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6299)),_N_E=e.O()}]);