(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[448],{1861:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/_register",function(){return s(4609)}])},3646:e=>{e.exports={container:"Page_container__4TqKj",main:"Page_main__MOW5Q",bold:"Page_bold__FOjUO",code:"Page_code__gdauj",grid:"Page_grid__YvlVv",card:"Page_card__qrbpT",description:"Page_description__F5wod",title:"Page_title__XbhM_"}},4609:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var r=s(7876),t=s(3646),n=s.n(t),o=s(4232);let i=()=>{let[e,a]=(0,o.useState)(null);return(0,o.useEffect)(()=>{a(localStorage),localStorage.getItem("idToken")&&(alert("すでにログインしているため、ポータルページに移動します。"),window.location.href="/portal");let e=new URLSearchParams(window.location.search).get("code");if(e){fetch("https://api.osudenken4dev.workers.dev/invite/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})}).then(e=>e.json()).then(e=>{e.valid||(alert("この招待コードは無効か期限切れです。"),window.location.href="/_register/")});let a=document.querySelector('input[name="passphrase"]');if(a){a.value=e,a.style.display="none";let s=document.getElementById("passphrase-label");s&&(s.style.display="none")}}},[]),(0,r.jsx)("div",{className:n().container,children:(0,r.jsxs)("main",{className:n().main,children:[(0,r.jsx)("h1",{children:"新規ユーザー登録"}),(0,r.jsxs)("p",{className:n().description,children:["大産大 電研部員のみが利用できるユーザーを作成します。",(0,r.jsx)("br",{}),"なお、部員ではない場合は却下されます。",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"学籍番号は先頭にsを付けてください。"]}),(0,r.jsxs)("form",{onSubmit:function(e){e.preventDefault();let a=new FormData(e.currentTarget),s=a.get("email");fetch("https://api.osudenken4dev.workers.dev/user/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:a.get("password"),passphrase:a.get("passphrase")})}).then(e=>e.json()).then(e=>{if(e.error)return"EMAIL_EXISTS"===e.error.message?void alert("そのメールアドレスは既に使われています。"):"Invalid passphrase or invite code"===e.message?void alert("合言葉が間違っています。"):void console.error("error:",e);e.success?(alert("ユーザー登録が完了しました。ログインページに移動します。"),window.location.href="/?i=portal/#login"):(console.error("Registration failed:",e),alert("ユーザー登録に失敗しました。"))}).catch(e=>{console.error("通信エラー or 想定外:",e),alert("サーバーと通信できませんでした。")})},children:[(0,r.jsxs)("label",{children:["学籍番号もしくはメールアドレス (osaka-sandai.ac.jpのみ)",(0,r.jsx)("input",{type:"text",name:"email"})]}),(0,r.jsxs)("label",{children:["パスワード",(0,r.jsx)("input",{type:"password",name:"password"})]}),(0,r.jsxs)("label",{id:"passphrase-label",children:["合言葉",(0,r.jsx)("input",{type:"text",name:"passphrase"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{type:"submit",value:"作成する"})]})]})})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=1861)),_N_E=e.O()}]);